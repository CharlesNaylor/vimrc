set nocompatible              " required
filetype off                  " required

" recursive search path
set path+=**
set wildmenu

" set the runtime path to include Vundle and initialize
set rtp+=~/.vim/bundle/Vundle.vim
call vundle#begin()

" alternatively, pass a path where Vundle should install plugins
"call vundle#begin('~/some/path/here')

" let Vundle manage Vundle, required
Plugin 'gmarik/Vundle.vim'

" Add all your plugins here (note older versions of Vundle used Bundle instead of Plugin)
Plugin 'tmhedberg/SimpylFold'
Plugin 'Valloric/YouCompleteMe'
Plugin 'vim-syntastic/syntastic'
Plugin 'fisadev/vim-isort' 		" sort python imports
Plugin 'tpope/vim-fugitive'		" git
Plugin 'eigenfoo/stan-vim' 		" Stan stuff
Plugin 'airblade/vim-gitgutter'  	" show changes
Plugin 'thaerkh/vim-indentguides'       " Visual representation of indents
Plugin 'Vimjas/vim-python-pep8-indent'  " Python indenting
Plugin 'ap/vim-buftabline'		" show open buffers as if they were tabs
Bundle 'powerline/powerline', {'rtp': 'powerline/bindings/vim/'}

" All of your Plugins must be added before the following line
call vundle#end()            " required
filetype on
filetype plugin on    " required
filetype plugin indent on    " required

"Folding
set foldmethod=indent
set foldlevel=99
nnoremap <space> za

"PEP8 Indentation
au BufNewFile,BufRead *.py
    \ set tabstop=4 |
    \ set softtabstop=4 |
    \ set shiftwidth=4 |
    \ set textwidth=99 |
    \ set expandtab |
    \ set autoindent |
    \ set fileformat=unix 

"Stan indentation
"au BufNewFile,BufRead *.stan
"    \ set tabstop=4 |
"    \ set softtabstop=4 |
"    \ set shiftwidth=4 |
"    \ set textwidth=79 |
"    \ set expandtab |
"    \ set autoindent |
"    \ set fileformat=unix |
"    \ set syntax=stan
"
"markdown indentation
au BufNewFile,BufRead *.*md
    \ set tabstop=4 |
    \ set softtabstop=4 |
    \ set shiftwidth=4 |
    \ set textwidth=0 |
    \ set expandtab |
    \ set autoindent |
    \ set fileformat=unix |
    \ set syntax=markdown

"Flag bad whitespace
highlight BadWhitespace ctermbg=red guibg=red
au BufRead,BufNewFile *.py,*.pyw,*.c,*.h match BadWhitespace /\s\+$/

set cursorline
set showmatch
set encoding=utf-8
set scrolloff=20
set clipboard=unnamed

"=====================================================
"" Tabs / Buffers settings
"=====================================================
tab sball
set switchbuf=useopen
set laststatus=2
nmap <F9> :bprev<CR>
nmap <F10> :bnext<CR>
nmap <silent> <leader>q :SyntasticCheck # <CR> :bp <BAR> bd #<CR>

"=====================================================
"" Convert formats with Pandoc
""  will set unsupported formats to read only
""  and convert them to markdown.
""  Commented out is an incomplete command to automate 
""    conversion on write. Not sure if I want that 
""    behavior
"=====================================================
autocmd BufReadPost *.doc,*.docx,*.rtf,*.odp,*.odt silent set ro
autocmd BufReadPost *.doc,*.docx,*.rtf,*.odp,*.odt silent setlocal nowrap
autocmd BufReadPost *.doc,*.docx,*.rtf,*.odp,*.odt silent %!pandoc "%" -t markdown -o /dev/stdout
"autocmd BufWritePost *.doc,*.docx,*.rtf,*.odp,*.odt silent %!pandoc "%" -f markdown -t "%" > tmp.jim

"=====================================================
"" Spellcheck Settings 
"=====================================================
"
autocmd BufReadPost *.doc,*.docx,*.rtf,*.odp,*.odt, *.tex silent setlocal spelllang=en_us
"=====================================================
"" Workspace Settings 
"=====================================================
nnoremap <Fc> :ToggleWorkspace<CR>
let g:workspace_autosave_always = 1

"=====================================================
"" Relative Numbering 
"=====================================================
nnoremap <F4> :set relativenumber!<CR>

"=====================================================
"" Search settings
"=====================================================
set incsearch	                            " incremental search
set hlsearch	                            " highlight search results

"" Set wildignore for vimgrep and find
set wildignore+=**/venv/**
set wildignore+=*.pyc
set wildignore+=*.parquet
set wildignore+=*.pickle
set wildignore+=*.pkl

"YouCompleteMe customizations
" Note <leader>d would be error diagnostics in C-family, which is awesome, but not available in python
let g:ycm_autoclose_preview_window_after_completion=1
map <leader>g  :YcmCompleter GoToDefinitionElseDeclaration<CR>
map <leader>d  :YcmCompleter GetDoc<CR>


"Highlighting
let python_highlight_all=1
syntax on

"Colorscheme
colorscheme elflord

" isort
let g:vim_isort_map = '<C-i>'

"line numbers
set nu
